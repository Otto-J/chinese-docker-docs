import{_ as s,c as e,o as a,N as n}from"./chunks/framework.dc3ff5a3.js";const D=JSON.parse('{"title":"Deploy to Kubernetes","description":"Learn how to describe and deploy a simple application on Kubernetes.","frontmatter":{"title":"Deploy to Kubernetes","keywords":"kubernetes, pods, deployments, kubernetes services","description":"Learn how to describe and deploy a simple application on Kubernetes."},"headers":[],"relativePath":"kube-deploy.md"}'),o={name:"kube-deploy.md"},l=n(`<h2 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-label="Permalink to &quot;Prerequisites&quot;">​</a></h2><ul><li><p>Download and install Docker Desktop as described in <a href="./../get-docker.html">Get Docker</a>.</p></li><li><p>Work through containerizing an application in <a href="./02_our_app.html">Part 2</a>.</p></li><li><p>Make sure that Kubernetes is enabled on your Docker Desktop:</p><ul><li><strong>Mac</strong>: Click the Docker icon in your menu bar, navigate to <strong>Settings</strong> and make sure there&#39;s a green light beside &#39;Kubernetes&#39;.</li><li><strong>Windows</strong>: Click the Docker icon in the system tray and navigate to <strong>Settings</strong> and make sure there&#39;s a green light beside &#39;Kubernetes&#39;.</li></ul><p>If Kubernetes isn&#39;t running, follow the instructions in <a href="./orchestration.html">Orchestration</a> of this tutorial to finish setting it up.</p></li></ul><h2 id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;Introduction&quot;">​</a></h2><p>Now that we&#39;ve demonstrated that the individual components of our application run as stand-alone containers, it&#39;s time to arrange for them to be managed by an orchestrator like Kubernetes. Kubernetes provides many tools for scaling, networking, securing and maintaining your containerized applications, above and beyond the abilities of containers themselves.</p><p>In order to validate that our containerized application works well on Kubernetes, we&#39;ll use Docker Desktop&#39;s built in Kubernetes environment right on our development machine to deploy our application, before handing it off to run on a full Kubernetes cluster in production. The Kubernetes environment created by Docker Desktop is <em>fully featured</em>, meaning it has all the Kubernetes features your app will enjoy on a real cluster, accessible from the convenience of your development machine.</p><h2 id="describing-apps-using-kubernetes-yaml" tabindex="-1">Describing apps using Kubernetes YAML <a class="header-anchor" href="#describing-apps-using-kubernetes-yaml" aria-label="Permalink to &quot;Describing apps using Kubernetes YAML&quot;">​</a></h2><p>All containers in Kubernetes are scheduled as <em>pods</em>, which are groups of co-located containers that share some resources. Furthermore, in a realistic application we almost never create individual pods; instead, most of our workloads are scheduled as <em>deployments</em>, which are scalable groups of pods maintained automatically by Kubernetes. Lastly, all Kubernetes objects can and should be described in manifests called <em>Kubernetes YAML</em> files. These YAML files describe all the components and configurations of your Kubernetes app, and can be used to easily create and destroy your app in any Kubernetes environment.</p><ol><li><p>You already wrote a very basic Kubernetes YAML file in the Orchestration overview part of this tutorial. Now, let&#39;s write a slightly more sophisticated YAML file to run and manage our Todo app, the container <code>getting-started</code> image created in <a href="./02_our_app.html">Part 2</a> of the Quickstart tutorial. Place the following in a file called <code>bb.yaml</code>:</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">apps/v1</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Deployment</span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">bb-demo</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">default</span></span>
<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">replicas</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">selector</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">matchLabels</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">bb</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">web</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">labels</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">bb</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">web</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">containers</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">bb-site</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">getting-started</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">imagePullPolicy</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Never</span></span>
<span class="line"><span style="color:#FFCB6B;">---</span></span>
<span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">v1</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Service</span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">bb-entrypoint</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">default</span></span>
<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">NodePort</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">selector</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">bb</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">web</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">port</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3000</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">targetPort</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3000</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">nodePort</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">30001</span></span>
<span class="line"></span></code></pre></div><p>In this Kubernetes YAML file, we have two objects, separated by the <code>---</code>:</p><ul><li>A <code>Deployment</code>, describing a scalable group of identical pods. In this case, you&#39;ll get just one <code>replica</code>, or copy of your pod, and that pod (which is described under the <code>template:</code> key) has just one container in it, based off of your <code>getting-started</code> image from the previous step in this tutorial.</li><li>A <code>NodePort</code> service, which will route traffic from port 30001 on your host to port 3000 inside the pods it routes to, allowing you to reach your Todo app from the network.</li></ul><p>Also, notice that while Kubernetes YAML can appear long and complicated at first, it almost always follows the same pattern:</p><ul><li>The <code>apiVersion</code>, which indicates the Kubernetes API that parses this object</li><li>The <code>kind</code> indicating what sort of object this is</li><li>Some <code>metadata</code> applying things like names to your objects</li><li>The <code>spec</code> specifying all the parameters and configurations of your object.</li></ul></li></ol><h2 id="deploy-and-check-your-application" tabindex="-1">Deploy and check your application <a class="header-anchor" href="#deploy-and-check-your-application" aria-label="Permalink to &quot;Deploy and check your application&quot;">​</a></h2><ol><li><p>In a terminal, navigate to where you created <code>bb.yaml</code> and deploy your application to Kubernetes:</p><div class="language-console"><button title="Copy Code" class="copy"></button><span class="lang">console</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">kubectl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">apply</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-f</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">bb.yaml</span></span>
<span class="line"></span></code></pre></div><p>you should see output that looks like the following, indicating your Kubernetes objects were created successfully:</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">deployment.apps/bb-demo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">created</span></span>
<span class="line"><span style="color:#FFCB6B;">service/bb-entrypoint</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">created</span></span>
<span class="line"></span></code></pre></div></li><li><p>Make sure everything worked by listing your deployments:</p><div class="language-console"><button title="Copy Code" class="copy"></button><span class="lang">console</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">kubectl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">get</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">deployments</span></span>
<span class="line"></span></code></pre></div><p>if all is well, your deployment should be listed as follows:</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">NAME</span><span style="color:#A6ACCD;">      </span><span style="color:#C3E88D;">READY</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">UP-TO-DATE</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">AVAILABLE</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">AGE</span></span>
<span class="line"><span style="color:#FFCB6B;">bb-demo</span><span style="color:#A6ACCD;">   </span><span style="color:#F78C6C;">1</span><span style="color:#C3E88D;">/</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">     </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">            </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">           </span><span style="color:#C3E88D;">40s</span></span>
<span class="line"></span></code></pre></div><p>This indicates all one of the pods you asked for in your YAML are up and running. Do the same check for your services:</p><div class="language-console"><button title="Copy Code" class="copy"></button><span class="lang">console</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">kubectl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">get</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">services</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">NAME</span><span style="color:#A6ACCD;">            </span><span style="color:#C3E88D;">TYPE</span><span style="color:#A6ACCD;">        </span><span style="color:#C3E88D;">CLUSTER-IP</span><span style="color:#A6ACCD;">       </span><span style="color:#C3E88D;">EXTERNAL-IP</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">PORT</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">S</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">          </span><span style="color:#C3E88D;">AGE</span></span>
<span class="line"><span style="color:#FFCB6B;">bb-entrypoint</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">NodePort</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">10.106.145.116</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">non</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">3000</span><span style="color:#C3E88D;">:</span><span style="color:#F78C6C;">30001</span><span style="color:#C3E88D;">/TCP</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">53s</span></span>
<span class="line"><span style="color:#FFCB6B;">kubernetes</span><span style="color:#A6ACCD;">      </span><span style="color:#C3E88D;">ClusterIP</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">10.96.0.1</span><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">non</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">443</span><span style="color:#C3E88D;">/TCP</span><span style="color:#A6ACCD;">          </span><span style="color:#C3E88D;">138d</span></span>
<span class="line"></span></code></pre></div><p>In addition to the default <code>kubernetes</code> service, we see our <code>bb-entrypoint</code> service, accepting traffic on port 30001/TCP.</p></li><li><p>Open a browser and visit your Todo app at <code>localhost:30001</code>; you should see your Todo application, the same as when we ran it as a stand-alone container in <a href="./02_our_app.html">Part 2</a> of the Quickstart tutorial.</p></li><li><p>Once satisfied, tear down your application:</p><div class="language-console"><button title="Copy Code" class="copy"></button><span class="lang">console</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">kubectl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">delete</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-f</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">bb.yaml</span></span>
<span class="line"></span></code></pre></div></li></ol><h2 id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;Conclusion&quot;">​</a></h2><p>At this point, we have successfully used Docker Desktop to deploy our application to a fully-featured Kubernetes environment on our development machine. We haven&#39;t done much with Kubernetes yet, but the door is now open; you can begin adding other components to your app and taking advantage of all the features and power of Kubernetes, right on your own machine.</p><p>In addition to deploying to Kubernetes, we have also described our application as a Kubernetes YAML file. This simple text file contains everything we need to create our application in a running state. We can check it into version control and share it with our colleagues, allowing us to distribute our applications to other clusters (like the testing and production clusters that probably come after our development environments) easily.</p><h2 id="kubernetes-references" tabindex="-1">Kubernetes references <a class="header-anchor" href="#kubernetes-references" aria-label="Permalink to &quot;Kubernetes references&quot;">​</a></h2><p>Further documentation for all new Kubernetes objects used in this article are available here:</p><ul><li><a href="https://kubernetes.io/docs/concepts/workloads/pods/pod/" target="_blank" rel="noreferrer">Kubernetes Pods</a></li><li><a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/" target="_blank" rel="noreferrer">Kubernetes Deployments</a></li><li><a href="https://kubernetes.io/docs/concepts/services-networking/service/" target="_blank" rel="noreferrer">Kubernetes Services</a></li></ul>`,16),p=[l];function t(r,c,i,y,d,C){return a(),e("div",null,p)}const h=s(o,[["render",t]]);export{D as __pageData,h as default};
