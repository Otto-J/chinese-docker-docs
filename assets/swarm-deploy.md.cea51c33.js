import{_ as e,c as a,o as s,N as o}from"./chunks/framework.dc3ff5a3.js";const m=JSON.parse('{"title":"Deploy to Swarm","description":"Learn how to describe and deploy a simple application on Docker Swarm.","frontmatter":{"title":"Deploy to Swarm","keywords":"swarm, swarm services, stacks","description":"Learn how to describe and deploy a simple application on Docker Swarm.","redirect_from":["/get-started/part4/"]},"headers":[],"relativePath":"swarm-deploy.md"}'),n={name:"swarm-deploy.md"},t=o(`<h2 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-label="Permalink to &quot;Prerequisites&quot;">​</a></h2><ul><li><p>Download and install Docker Desktop as described in <a href="./../get-docker.html">Get Docker</a>.</p></li><li><p>Work through containerizing an application in <a href="./02_our_app.html">Part 2</a>.</p></li><li><p>Make sure that Swarm is enabled on your Docker Desktop by typing <code>docker system info</code>, and looking for a message <code>Swarm: active</code> (you might have to scroll up a little).</p><p>If Swarm isn&#39;t running, simply type <code>docker swarm init</code> in a shell prompt to set it up.</p></li></ul><h2 id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;Introduction&quot;">​</a></h2><p>Now that we&#39;ve demonstrated that the individual components of our application run as stand-alone containers and shown how to deploy it using Kubernetes, let&#39;s look at how to arrange for them to be managed by Docker Swarm. Swarm provides many tools for scaling, networking, securing and maintaining your containerized applications, above and beyond the abilities of containers themselves.</p><p>In order to validate that our containerized application works well on Swarm, we&#39;ll use Docker Desktop&#39;s built in Swarm environment right on our development machine to deploy our application, before handing it off to run on a full Swarm cluster in production. The Swarm environment created by Docker Desktop is <em>fully featured</em>, meaning it has all the Swarm features your app will enjoy on a real cluster, accessible from the convenience of your development machine.</p><h2 id="describe-apps-using-stack-files" tabindex="-1">Describe apps using stack files <a class="header-anchor" href="#describe-apps-using-stack-files" aria-label="Permalink to &quot;Describe apps using stack files&quot;">​</a></h2><p>Swarm never creates individual containers like we did in the previous step of this tutorial. Instead, all Swarm workloads are scheduled as <em>services</em>, which are scalable groups of containers with added networking features maintained automatically by Swarm. Furthermore, all Swarm objects can and should be described in manifests called <em>stack files</em>. These YAML files describe all the components and configurations of your Swarm app, and can be used to easily create and destroy your app in any Swarm environment.</p><p>Let&#39;s write a simple stack file to run and manage our Todo app, the container <code>getting-started</code> image created in <a href="./02_our_app.html">Part 2</a> of the Quickstart tutorial. Place the following in a file called <code>bb-stack.yaml</code>:</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F07178;">version</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">3.7</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">services</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">bb-app</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">getting-started</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8000:3000</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><p>In this Swarm YAML file, we have just one object: a <code>service</code>, describing a scalable group of identical containers. In this case, you&#39;ll get just one container (the default), and that container will be based on your <code>getting-started</code> image created in <a href="./02_our_app.html">Part 2</a> of the Quickstart tutorial. In addition, We&#39;ve asked Swarm to forward all traffic arriving at port 8000 on our development machine to port 3000 inside our getting-started container.</p><blockquote><p><strong>Kubernetes Services and Swarm Services are very different!</strong> Despite the similar name, the two orchestrators mean very different things by the term &#39;service&#39;. In Swarm, a service provides both scheduling <em>and</em> networking facilities, creating containers and providing tools for routing traffic to them. In Kubernetes, scheduling and networking are handled separately: <em>deployments</em> (or other controllers) handle the scheduling of containers as pods, while <em>services</em> are responsible only for adding networking features to those pods.</p></blockquote><h2 id="deploy-and-check-your-application" tabindex="-1">Deploy and check your application <a class="header-anchor" href="#deploy-and-check-your-application" aria-label="Permalink to &quot;Deploy and check your application&quot;">​</a></h2><ol><li><p>Deploy your application to Swarm:</p><div class="language-console"><button title="Copy Code" class="copy"></button><span class="lang">console</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">stack</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">deploy</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-c</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">bb-stack.yaml</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">demo</span></span>
<span class="line"></span></code></pre></div><p>If all goes well, Swarm will report creating all your stack objects with no complaints:</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">Creating</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">network</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">demo_default</span></span>
<span class="line"><span style="color:#FFCB6B;">Creating</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">service</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">demo_bb-app</span></span>
<span class="line"></span></code></pre></div><p>Notice that in addition to your service, Swarm also creates a Docker network by default to isolate the containers deployed as part of your stack.</p></li><li><p>Make sure everything worked by listing your service:</p><div class="language-console"><button title="Copy Code" class="copy"></button><span class="lang">console</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">service</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ls</span></span>
<span class="line"></span></code></pre></div><p>If all has gone well, your service will report with 1/1 of its replicas created:</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">ID</span><span style="color:#A6ACCD;">                  </span><span style="color:#C3E88D;">NAME</span><span style="color:#A6ACCD;">                </span><span style="color:#C3E88D;">MODE</span><span style="color:#A6ACCD;">                </span><span style="color:#C3E88D;">REPLICAS</span><span style="color:#A6ACCD;">            </span><span style="color:#C3E88D;">IMAGE</span><span style="color:#A6ACCD;">               </span><span style="color:#C3E88D;">PORTS</span></span>
<span class="line"><span style="color:#FFCB6B;">il7elwunymbs</span><span style="color:#A6ACCD;">        </span><span style="color:#C3E88D;">demo_bb-app</span><span style="color:#A6ACCD;">         </span><span style="color:#C3E88D;">replicated</span><span style="color:#A6ACCD;">          </span><span style="color:#F78C6C;">1</span><span style="color:#C3E88D;">/</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">                 </span><span style="color:#C3E88D;">getting-started:latest</span><span style="color:#A6ACCD;">   </span><span style="color:#A6ACCD;">*</span><span style="color:#C3E88D;">:</span><span style="color:#F78C6C;">8000</span><span style="color:#A6ACCD;">-</span><span style="color:#89DDFF;">&gt;</span><span style="color:#F78C6C;">3000</span><span style="color:#C3E88D;">/tcp</span></span>
<span class="line"></span></code></pre></div><p>This indicates 1/1 containers you asked for as part of your services are up and running. Also, we see that port 8000 on your development machine is getting forwarded to port 3000 in your getting-started container.</p></li><li><p>Open a browser and visit your Todo app at <code>localhost:8000</code>; you should see your Todo application, the same as when we ran it as a stand-alone container in Part 2 of the Quickstart tutorial.</p></li><li><p>Once satisfied, tear down your application:</p><div class="language-console"><button title="Copy Code" class="copy"></button><span class="lang">console</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">stack</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">rm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">demo</span></span>
<span class="line"></span></code></pre></div></li></ol><h2 id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;Conclusion&quot;">​</a></h2><p>At this point, we have successfully used Docker Desktop to deploy our application to a fully-featured Swarm environment on our development machine. We haven&#39;t done much with Swarm yet, but the door is now open: you can begin adding other components to your app and taking advantage of all the features and power of Swarm, right on your own machine.</p><p>In addition to deploying to Swarm, we have also described our application as a stack file. This simple text file contains everything we need to create our application in a running state; we can check it into version control and share it with our colleagues, allowing us to distribute our applications to other clusters (like the testing and production clusters that probably come after our development environments) easily.</p><h2 id="swarm-and-cli-references" tabindex="-1">Swarm and CLI references <a class="header-anchor" href="#swarm-and-cli-references" aria-label="Permalink to &quot;Swarm and CLI references&quot;">​</a></h2><p>Further documentation for all new Swarm objects and CLI commands used in this article are available here:</p><ul><li><a href="./../engine/swarm/">Swarm Mode</a></li><li><a href="./../engine/swarm/how-swarm-mode-works/services.html">Swarm Mode Services</a></li><li><a href="./../engine/swarm/stack-deploy.html">Swarm Stacks</a></li><li><a href="/chinese-docker-docs/engine/reference/commandline/stack/"><code>docker stack *</code></a></li><li><a href="/chinese-docker-docs/engine/reference/commandline/service/"><code>docker service *</code></a></li></ul>`,19),l=[t];function r(p,i,c,d,y,u){return s(),a("div",null,l)}const C=e(n,[["render",r]]);export{m as __pageData,C as default};
